Назначение программы:
Создание листов по рамкам, указанным пользователем в модели. Автоматический выбор форматов бумаги и настройка листов.

Принцип работы:
- Программа формирует предварительный список настроек листа, с форматами бумаги
    Список формируется двумя способами
    1. Из DWG to PDF.pc3
        Выбираются все пользовательские форматы
        В конец списка добавляются форматы, начинающиеся на "ISO A.."
        Область печати выставляется "Лист"
        Единицы измерения - миллиметры
        Масштаб 1:1
        Стиль печати - acad.ctb. Позже буду брать из файла конфигурации
        Имя настройки берётся из имени формата бумаги. Если встречаются символы из ряда "\<>/?"":;*|,=`" - убираются
    2. Из файла шаблона
        Копируются пользовательские именованные настройки печати, доступные из диалога "Page setup"
        Повторяю. Пользовательски настройки. Не листы, а именно настройки
        Ещё раз. В листы не заглядываем ВООБЩЕ
        Соответственно, имя настройки печати не должно начинаться с символа звёздочки "*"
- Запрашивает у пользователя "референтный размер".
    Используется для определения масштаба рамки. По-умолчанию это 185 мм. - длина основной надписи
- Запрашивает у пользователя противоположные углы рамок
    Слева-направо, сверху-вниз, или наоборот - не важно
    Привязка принудительно выставляется "конточка"
- На основе масштаба и списка форматов определяет наиболее подходящий
    При этом используется строго ориентация из "списка". Ориентацию с книжной на альбомную и обратно программа произвольно не меняет. Строго по "списку настроек"
- По выбранным форматам бумаги создаёт листы
    В чертёж добавляет подходящие именованные настройки из "списка", настроенные на нужный формат бумаги
    Присваивает созданным листам соответствующие именованные настройки
- Создаёт видовой экран, "смотрящий" на рамку, указанную пользователем

Процесс работы:
1. Для вызова программы введите в ком. строку lfm
2. Либо задайте номер первого создаваемого листа, либо используйте опции ком. строки
3. Укажите "референтный" размер
4. Указывайте рамки, кликая по противоположным углам рамок.
    Опции ком. строки см. соответствующий раздел
5. По окончании жмите escape или используйте опцию P

Конфигурация:
- Файл конфигурации. Имя файла - lfmsettings.xml. Хранится рядом программой
    Содержимое, не используемое диалогом конфигурации:
        - ReferenceDimension (По-умолчанию - 185). Референтный размер. Масштаб рамки будет определяться как отношение указанного пользователем размера к размеру в конфигурации. Если у вас референтный размер другой - можете изменить вручную
        - TemplatePath. Путь к шаблону для формирования списка настроек листов. Устанавливается программой при выборе опции templateSelect
    Диалог конфигурации:
        - Префикс - Префикс имени создаваемого листа
        - Суффикс - Суффикс имени создаваемого листа
        - Точность определения форматов - Отвечает за точность определения форматов. Суть в том, что форматки иногда бывают примерно  по госту. Таким образом, если указываемая форматка больше гостовского размера (уже после скалирования) на указанный размер - будет выбран соответствующий формат бумаги. Значение - целое число. По умолчанию = 10 мм
        - Удалять неинициализированые листы - Удалять ли листы, на которые ни разу не заходил пользователь
        - Оставаться в модели по окончании работы - Возвращать ли пользователя в модель по окончании работы программы

Опции ком. строки:
    - Undo - Отменить выбор последней рамки
    - Newscale - Задать новый масштаб рамки
    - Process - Выполнить создание листов
    - Configuration - Вызвать диалог конфигурации
    - useTemplate - Для создания листов использовать ранее выбранный шаблонный файл
    - templateSelect - Выбрать шаблонный файл. Переменная FILEDIA влияет на вид запроса (можно использовать в макросах)

Известные проблемы:
    - Если настройки листа подразумевают область печати Extents, и стоит галка Fit to paper - возможно неправильное отображение области бумаги в пространстве листа. На печать не влияет
    - Пока больше ничего не вспомнить


http://mind42.com/mindmap/941c4e75-f2c4-4743-864a-59fb15820f95?rel=url